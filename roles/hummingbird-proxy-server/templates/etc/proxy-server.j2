[DEFAULT]
bind_ip = {{ service_ip }}
bind_port = {{ proxy_port }}
log_level = INFO
user = hummingbird
tempauth_enabled = {{ use_temp_auth }}
obfuscated_prefix = {{ proxy_obfuscated_prefix }}

[app:proxy-server]
allow_account_management = true
account_autocreate = true

[filter:cache]
memcache_servers = {{ groups['hummingbird'] | map('extract', hostvars, ['service_ip']) | join(':11211,') }}:11211

[filter:tempauth]
user_admin_admin = admin .admin .reseller_admin
user_test_tester = testing .admin
user_test2_tester2 = testing2 .admin
user_test_tester3 = testing3

{% if auth_uri is defined %}
[filter:authtoken]
paste.filter_factory = keystonemiddleware.auth_token:filter_factory
auth_uri = {{ auth_uri }}
auth_url = {{ auth_url }}
auth_plugin = password
project_domain_id = default
user_domain_id = default
project_name = service
username = {{ authtoken_username }}
password = {{ authtoken_password }}
cache = swift.cache
include_service_catalog = False
delay_auth_decision = True

[filter:keystoneauth]
reseller_prefix = AUTH
operator_roles = admin, swiftoperator
reseller_admin_role = ResellerAdmin
GLANCE_service_roles = service
default_domain_id = default
allow_names_in_acls = false
{% endif %}

[filter:catch_errors]

[filter:healthcheck]

[filter:proxy-logging]

[filter:ratelimit]
account_db_max_writes_per_sec = {{ account_db_max_writes_per_sec }}
container_db_max_writes_per_sec = {{ container_db_max_writes_per_sec }}

[filter:dlo]

[filter:slo]

[filter:tempurl]

[filter:staticweb]

[filter:copy]

{% if tracing_enabled %}
[tracing]
agent_host_port = {{ tracing_agent_host_port }}
#disabled = false
sampler_type = {{ tracing_sampler_type }}
sampler_param = {{ tracing_sampler_param }}
reporter_log_spans = {{ tracing_reporter_log_spans }}
enable_httptrace = {{ tracing_enable_httptrace }}
{% endif %}
